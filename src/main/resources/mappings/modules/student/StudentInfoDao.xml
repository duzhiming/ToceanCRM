<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.thinkgem.jeesite.modules.student.dao.StudentInfoDao">
    
	<sql id="studentInfoColumns">
		a.userid AS "userid",
		a.name AS "name",
		a.code AS "code",
		a.statuschange AS "statuschange",
		a.studenttype AS "studenttype",
		a.sex AS "sex",
		a.birthplace AS "birthplace",
		a.birthday AS "birthday",
		a.married AS "married",
		a.school AS "school",
		a.department AS "department",
		a.collegemajor AS "collegemajor",
		a.schoolrecord AS "schoolrecord",
		a.graduatedate AS "graduatedate",
		a.telephone AS "telephone",
		a.gtelephone AS "gtelephone",
		a.email AS "email",
		a.qq AS "qq",
		a.msn AS "msn",
		a.homephone AS "homephone",
		a.homeaddress AS "homeaddress",
		a.comminucationaddress AS "comminucationaddress",
		a.credentialno AS "credentialno",
		a.guardian AS "guardian",
		a.guardianphone AS "guardianphone",
		a.relation AS "relation",
		a.urgencyperson AS "urgencyperson",
		a.urgencyphone AS "urgencyphone",
		a.traincompany AS "traincompany",
		a.traintime AS "traintime",
		a.traincontext AS "traincontext",
		a.oldcompany AS "oldcompany",
		a.oldheadship AS "oldheadship",
		a.oldsalary AS "oldsalary",
		a.familybackgroud AS "familybackgroud",
		a.parentstatus AS "parentstatus",
		a.jobdesign AS "jobdesign",
		a.target AS "target",
		a.hobby AS "hobby",
		a.economy AS "economy",
		a.qulityscore AS "qulityscore",
		a.skillscore AS "skillscore",
		a.innerheadship AS "innerheadship",
		a.daneigraduatedate AS "daneigraduatedate",
		a.pic AS "pic",
		a.picfilename AS "picfilename",
		a.resume AS "resume",
		a.resumefilename AS "resumefilename",
		a.repayedcredit AS "repayedcredit",
		a.careerexclamation AS "careerexclamation",
		a.company AS "company",
		a.salary AS "salary",
		a.returnvist AS "returnvist",
		a.teacherevaluation AS "teacherevaluation",
		a.pmevaluation AS "pmevaluation",
		a.firstwritten AS "firstwritten",
		a.secondwritten AS "secondwritten",
		a.thirdwritten AS "thirdwritten",
		a.scjp AS "scjp",
		a.firstpoll AS "firstpoll",
		a.secondpoll AS "secondpoll",
		a.thirdpoll AS "thirdpoll",
		a.classes_id AS "classes.id",
		u1.name AS "classes.name",
		a.create_by AS "createBy.id",
		a.create_date AS "createDate",
		a.update_by AS "updateBy.id",
		a.update_date AS "updateDate",
		a.remarks AS "remarks",
		a.del_flag AS "delFlag"
	</sql>
	
	<sql id="studentInfoJoins">
		LEFT JOIN crm_classes u1 ON u1.id =a.classes_id
	</sql>
    
	<select id="get" resultType="StudentInfo">
		SELECT 
			<include refid="studentInfoColumns"/>
		FROM crm_student_info a
		<include refid="studentInfoJoins"/>
		WHERE a.userid = #{id}
	</select>
	
	<select id="findList" resultType="StudentInfo">
		SELECT 
			<include refid="studentInfoColumns"/>
		FROM crm_student_info a
		<include refid="studentInfoJoins"/>
		<where>
			a.del_flag = #{DEL_FLAG_NORMAL}
			<if test="name != null and name != ''">
				AND a.name LIKE 
					<if test="dbName == 'oracle'">'%'||#{name}||'%'</if>
					<if test="dbName == 'mssql'">'%'+#{name}+'%'</if>
					<if test="dbName == 'mysql'">concat('%',#{name},'%')</if>
			</if>
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
				ORDER BY a.update_date DESC
			</otherwise>
		</choose>
	</select>
	
	<select id="findAllList" resultType="StudentInfo">
		SELECT 
			<include refid="studentInfoColumns"/>
		FROM crm_student_info a
		<include refid="studentInfoJoins"/>
		<where>
			a.del_flag = #{DEL_FLAG_NORMAL}
		</where>		
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
				ORDER BY a.update_date DESC
			</otherwise>
		</choose>
	</select>
	
	<insert id="insert">
		INSERT INTO crm_student_info(
			userid,
			name,
			code,
			statuschange,
			studenttype,
			sex,
			birthplace,
			birthday,
			married,
			school,
			department,
			collegemajor,
			schoolrecord,
			graduatedate,
			telephone,
			gtelephone,
			email,
			qq,
			msn,
			homephone,
			homeaddress,
			comminucationaddress,
			credentialno,
			guardian,
			guardianphone,
			relation,
			urgencyperson,
			urgencyphone,
			traincompany,
			traintime,
			traincontext,
			oldcompany,
			oldheadship,
			oldsalary,
			familybackgroud,
			parentstatus,
			jobdesign,
			target,
			hobby,
			economy,
			qulityscore,
			skillscore,
			innerheadship,
			daneigraduatedate,
			pic,
			picfilename,
			resume,
			resumefilename,
			repayedcredit,
			careerexclamation,
			company,
			salary,
			returnvist,
			teacherevaluation,
			pmevaluation,
			firstwritten,
			secondwritten,
			thirdwritten,
			scjp,
			firstpoll,
			secondpoll,
			thirdpoll,
			classes_id,
			create_by,
			create_date,
			update_by,
			update_date,
			remarks,
			del_flag
		) VALUES (
			#{userid},
			#{name},
			#{code},
			#{statuschange},
			#{studenttype},
			#{sex},
			#{birthplace},
			#{birthday},
			#{married},
			#{school},
			#{department},
			#{collegemajor},
			#{schoolrecord},
			#{graduatedate},
			#{telephone},
			#{gtelephone},
			#{email},
			#{qq},
			#{msn},
			#{homephone},
			#{homeaddress},
			#{comminucationaddress},
			#{credentialno},
			#{guardian},
			#{guardianphone},
			#{relation},
			#{urgencyperson},
			#{urgencyphone},
			#{traincompany},
			#{traintime},
			#{traincontext},
			#{oldcompany},
			#{oldheadship},
			#{oldsalary},
			#{familybackgroud},
			#{parentstatus},
			#{jobdesign},
			#{target},
			#{hobby},
			#{economy},
			#{qulityscore},
			#{skillscore},
			#{innerheadship},
			#{daneigraduatedate},
			#{pic},
			#{picfilename},
			#{resume},
			#{resumefilename},
			#{repayedcredit},
			#{careerexclamation},
			#{company},
			#{salary},
			#{returnvist},
			#{teacherevaluation},
			#{pmevaluation},
			#{firstwritten},
			#{secondwritten},
			#{thirdwritten},
			#{scjp},
			#{firstpoll},
			#{secondpoll},
			#{thirdpoll},
			#{classes.id},
			#{createBy.id},
			#{createDate},
			#{updateBy.id},
			#{updateDate},
			#{remarks},
			#{delFlag}
		)
	</insert>
	
	<update id="update">
		UPDATE crm_student_info SET 	
			userid = #{userid},
			name = #{name},
			code = #{code},
			statuschange = #{statuschange},
			studenttype = #{studenttype},
			sex = #{sex},
			birthplace = #{birthplace},
			birthday = #{birthday},
			married = #{married},
			school = #{school},
			department = #{department},
			collegemajor = #{collegemajor},
			schoolrecord = #{schoolrecord},
			graduatedate = #{graduatedate},
			telephone = #{telephone},
			gtelephone = #{gtelephone},
			email = #{email},
			qq = #{qq},
			msn = #{msn},
			homephone = #{homephone},
			homeaddress = #{homeaddress},
			comminucationaddress = #{comminucationaddress},
			credentialno = #{credentialno},
			guardian = #{guardian},
			guardianphone = #{guardianphone},
			relation = #{relation},
			urgencyperson = #{urgencyperson},
			urgencyphone = #{urgencyphone},
			traincompany = #{traincompany},
			traintime = #{traintime},
			traincontext = #{traincontext},
			oldcompany = #{oldcompany},
			oldheadship = #{oldheadship},
			oldsalary = #{oldsalary},
			familybackgroud = #{familybackgroud},
			parentstatus = #{parentstatus},
			jobdesign = #{jobdesign},
			target = #{target},
			hobby = #{hobby},
			economy = #{economy},
			qulityscore = #{qulityscore},
			skillscore = #{skillscore},
			innerheadship = #{innerheadship},
			daneigraduatedate = #{daneigraduatedate},
			pic = #{pic},
			picfilename = #{picfilename},
			resume = #{resume},
			resumefilename = #{resumefilename},
			repayedcredit = #{repayedcredit},
			careerexclamation = #{careerexclamation},
			company = #{company},
			salary = #{salary},
			returnvist = #{returnvist},
			teacherevaluation = #{teacherevaluation},
			pmevaluation = #{pmevaluation},
			firstwritten = #{firstwritten},
			secondwritten = #{secondwritten},
			thirdwritten = #{thirdwritten},
			scjp = #{scjp},
			firstpoll = #{firstpoll},
			secondpoll = #{secondpoll},
			thirdpoll = #{thirdpoll},
			classes_id = #{classes.id},
			update_by = #{updateBy.id},
			update_date = #{updateDate},
			remarks = #{remarks}
		WHERE userid = #{id}
	</update>
	
	<update id="delete">
		UPDATE crm_student_info SET 
			del_flag = #{DEL_FLAG_DELETE}
		WHERE userid = #{id}
	</update>
	
</mapper>